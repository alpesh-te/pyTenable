'''
Testing the Vulneravility Schema
'''
from tenable.io.v3.vm.vulnerabilities.schema import VulnerabilitySchema


def test_schema():
    '''
    Tests the Schema for Vulnerability API
    '''
    schema = VulnerabilitySchema()

    vendor = 'tenable'
    product = 'tenable.io'
    data_type = 'vm'
    source = ('75c6c4c3-1626-4b57-9095-71b58ff8999e:'
              'e9b89d18-87cc-4fd5-8e6f-27a1d24fa2ac0')
    assets = [{
        'network_interfaces': [{
            'ipv4': ['192.0.2.57', '192.0.2.177']
        }],
        'hostname': 'windsmb.server.example.com',
        'bios_uuid': '9c60da51-762a-4b9b-8504-411056c2f696',
        'netbios_name': 'JUPITER',
        'vulnerabilities': [{
            'tenable_plugin_id': '97737',
            'last_found': 1568086236,
            'output': ('Description: The remote Windows host is '
                       'missing a security update.')
        }]
    }]
    coverage = '24531,76010-76023,88107'

    data = {
        'vendor': vendor,
        'data_type': data_type,
        'source': source,
        'assets': assets,
        'product': product,
        'coverage': coverage
    }

    assert schema.dump(schema.load(data)) == data
